<?xml version="1.0" encoding="UTF-8"?>
<svg width="1400" height="820" viewBox="0 0 1400 820" xmlns="http://www.w3.org/2000/svg" font-family="'Segoe UI', 'Inter', Arial, sans-serif">
  <defs>
    <!-- Background gradient -->
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#050c1a"/>
      <stop offset="100%" style="stop-color:#0a1628"/>
    </linearGradient>

    <!-- Node gradients -->
    <linearGradient id="gBrowser" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#1d4ed8"/>
    </linearGradient>
    <linearGradient id="gGateway" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>
    <linearGradient id="gKeycloak" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <linearGradient id="gUI" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#6366f1"/>
      <stop offset="100%" style="stop-color:#4f46e5"/>
    </linearGradient>
    <linearGradient id="gEcom" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>
    <linearGradient id="gInven" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <linearGradient id="gRedis" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ef4444"/>
      <stop offset="100%" style="stop-color:#dc2626"/>
    </linearGradient>
    <linearGradient id="gKafka" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ea580c"/>
      <stop offset="100%" style="stop-color:#c2410c"/>
    </linearGradient>
    <linearGradient id="gDebezium" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#dc2626"/>
      <stop offset="100%" style="stop-color:#b91c1c"/>
    </linearGradient>
    <linearGradient id="gAnalytics" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#7c3aed"/>
    </linearGradient>
    <linearGradient id="gSuperset" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#0891b2"/>
      <stop offset="100%" style="stop-color:#0e7490"/>
    </linearGradient>
    <linearGradient id="gDb" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1e40af"/>
      <stop offset="100%" style="stop-color:#1e3a8a"/>
    </linearGradient>

    <!-- Glow filter -->
    <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <filter id="glowStrong" x="-30%" y="-30%" width="160%" height="160%">
      <feGaussianBlur stdDeviation="5" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>

    <!-- Arrow markers -->
    <marker id="arrowBlue" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#3b82f6"/>
    </marker>
    <marker id="arrowGreen" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#10b981"/>
    </marker>
    <marker id="arrowOrange" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#f59e0b"/>
    </marker>
    <marker id="arrowPurple" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#8b5cf6"/>
    </marker>
    <marker id="arrowTeal" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#0891b2"/>
    </marker>
    <marker id="arrowRed" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#ef4444"/>
    </marker>
    <marker id="arrowKafka" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#ea580c"/>
    </marker>
    <marker id="arrowWhite" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="rgba(255,255,255,0.6)"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="820" fill="url(#bgGrad)"/>

  <!-- Subtle grid -->
  <g opacity="0.04" stroke="#60a5fa" stroke-width="1">
    <line x1="0" y1="80" x2="1400" y2="80"/>
    <line x1="0" y1="160" x2="1400" y2="160"/>
    <line x1="0" y1="240" x2="1400" y2="240"/>
    <line x1="0" y1="320" x2="1400" y2="320"/>
    <line x1="0" y1="400" x2="1400" y2="400"/>
    <line x1="0" y1="480" x2="1400" y2="480"/>
    <line x1="0" y1="560" x2="1400" y2="560"/>
    <line x1="0" y1="640" x2="1400" y2="640"/>
    <line x1="0" y1="720" x2="1400" y2="720"/>
    <line x1="200" y1="0" x2="200" y2="820"/>
    <line x1="400" y1="0" x2="400" y2="820"/>
    <line x1="600" y1="0" x2="600" y2="820"/>
    <line x1="800" y1="0" x2="800" y2="820"/>
    <line x1="1000" y1="0" x2="1000" y2="820"/>
    <line x1="1200" y1="0" x2="1200" y2="820"/>
  </g>

  <!-- Title -->
  <text x="700" y="38" text-anchor="middle" font-size="22" font-weight="700" fill="white" filter="url(#glow)">BookStore Platform â€” Live Data Flow</text>
  <text x="700" y="62" text-anchor="middle" font-size="12" fill="#60a5fa">Animated request paths Â· mTLS mesh Â· CDC pipeline Â· Real-time analytics</text>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LAYER LABELS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="8" y="90" width="52" height="80" rx="6" fill="rgba(59,130,246,0.15)" stroke="rgba(59,130,246,0.3)" stroke-width="1"/>
  <text transform="rotate(-90,34,130)" x="34" y="130" text-anchor="middle" font-size="8" font-weight="700" fill="#93c5fd">CLIENT</text>

  <rect x="8" y="184" width="52" height="80" rx="6" fill="rgba(16,185,129,0.15)" stroke="rgba(16,185,129,0.3)" stroke-width="1"/>
  <text transform="rotate(-90,34,224)" x="34" y="224" text-anchor="middle" font-size="8" font-weight="700" fill="#6ee7b7">INGRESS</text>

  <rect x="8" y="278" width="52" height="172" rx="6" fill="rgba(99,102,241,0.15)" stroke="rgba(99,102,241,0.3)" stroke-width="1"/>
  <text transform="rotate(-90,34,364)" x="34" y="364" text-anchor="middle" font-size="8" font-weight="700" fill="#a5b4fc">SERVICES</text>

  <rect x="8" y="464" width="52" height="172" rx="6" fill="rgba(234,88,12,0.15)" stroke="rgba(234,88,12,0.3)" stroke-width="1"/>
  <text transform="rotate(-90,34,550)" x="34" y="550" text-anchor="middle" font-size="8" font-weight="700" fill="#fdba74">DATA LAYER</text>

  <rect x="8" y="650" width="52" height="154" rx="6" fill="rgba(139,92,246,0.15)" stroke="rgba(139,92,246,0.3)" stroke-width="1"/>
  <text transform="rotate(-90,34,727)" x="34" y="727" text-anchor="middle" font-size="8" font-weight="700" fill="#c4b5fd">ANALYTICS</text>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NODES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

  <!-- BROWSER (top center) -->
  <rect x="566" y="90" width="268" height="72" rx="14" fill="url(#gBrowser)" filter="url(#glowStrong)" opacity="0.95"/>
  <rect x="566" y="90" width="268" height="72" rx="14" fill="none" stroke="rgba(147,197,253,0.5)" stroke-width="1.5"/>
  <text x="700" y="116" text-anchor="middle" font-size="24" fill="white">ğŸŒ</text>
  <text x="700" y="138" text-anchor="middle" font-size="13" font-weight="700" fill="white">User Browser</text>
  <text x="700" y="153" text-anchor="middle" font-size="10" fill="#bfdbfe">React SPA Â· OIDC PKCE Â· In-memory tokens</text>

  <!-- KGATEWAY (ingress center) -->
  <rect x="566" y="184" width="268" height="72" rx="14" fill="url(#gGateway)" filter="url(#glowStrong)" opacity="0.95"/>
  <rect x="566" y="184" width="268" height="72" rx="14" fill="none" stroke="rgba(110,231,183,0.5)" stroke-width="1.5"/>
  <text x="700" y="210" text-anchor="middle" font-size="22" fill="white">âš¡</text>
  <text x="700" y="232" text-anchor="middle" font-size="13" font-weight="700" fill="white">Istio Gateway</text>
  <text x="700" y="247" text-anchor="middle" font-size="10" fill="#d1fae5">K8s Gateway API Â· gatewayClassName: istio Â· NodePort :30000</text>

  <!-- KEYCLOAK (ingress right) -->
  <rect x="1050" y="184" width="220" height="72" rx="14" fill="url(#gKeycloak)" filter="url(#glow)" opacity="0.95"/>
  <rect x="1050" y="184" width="220" height="72" rx="14" fill="none" stroke="rgba(253,230,138,0.4)" stroke-width="1.5"/>
  <text x="1160" y="210" text-anchor="middle" font-size="20" fill="white">ğŸ”</text>
  <text x="1160" y="232" text-anchor="middle" font-size="13" font-weight="700" fill="white">Keycloak 26.5.4</text>
  <text x="1160" y="247" text-anchor="middle" font-size="10" fill="#fef9c3">OIDC IdP Â· realm: bookstore</text>

  <!-- UI SERVICE -->
  <rect x="80" y="278" width="220" height="86" rx="14" fill="url(#gUI)" filter="url(#glow)" opacity="0.92"/>
  <rect x="80" y="278" width="220" height="86" rx="14" fill="none" stroke="rgba(165,180,252,0.4)" stroke-width="1.5"/>
  <text x="190" y="304" text-anchor="middle" font-size="18" fill="white">ğŸ–¥ï¸</text>
  <text x="190" y="325" text-anchor="middle" font-size="12" font-weight="700" fill="white">UI Service</text>
  <text x="190" y="341" text-anchor="middle" font-size="10" fill="#c7d2fe">React 19.2 / Nginx</text>
  <text x="190" y="355" text-anchor="middle" font-size="10" fill="#a5b4fc">myecom.net:30000</text>

  <!-- ECOM SERVICE -->
  <rect x="490" y="278" width="240" height="86" rx="14" fill="url(#gEcom)" filter="url(#glow)" opacity="0.92"/>
  <rect x="490" y="278" width="240" height="86" rx="14" fill="none" stroke="rgba(110,231,183,0.4)" stroke-width="1.5"/>
  <text x="610" y="304" text-anchor="middle" font-size="18" fill="white">ğŸ›’</text>
  <text x="610" y="325" text-anchor="middle" font-size="12" font-weight="700" fill="white">E-Commerce Service</text>
  <text x="610" y="341" text-anchor="middle" font-size="10" fill="#d1fae5">Spring Boot 4.0.3</text>
  <text x="610" y="355" text-anchor="middle" font-size="10" fill="#a7f3d0">api.service.net/ecom</text>

  <!-- INVENTORY SERVICE -->
  <rect x="800" y="278" width="240" height="86" rx="14" fill="url(#gInven)" filter="url(#glow)" opacity="0.92"/>
  <rect x="800" y="278" width="240" height="86" rx="14" fill="none" stroke="rgba(253,230,138,0.4)" stroke-width="1.5"/>
  <text x="920" y="304" text-anchor="middle" font-size="18" fill="white">ğŸ“¦</text>
  <text x="920" y="325" text-anchor="middle" font-size="12" font-weight="700" fill="white">Inventory Service</text>
  <text x="920" y="341" text-anchor="middle" font-size="10" fill="#fef9c3">Python FastAPI</text>
  <text x="920" y="355" text-anchor="middle" font-size="10" fill="#fde68a">api.service.net/inven</text>

  <!-- REDIS -->
  <rect x="1100" y="278" width="190" height="86" rx="14" fill="url(#gRedis)" filter="url(#glow)" opacity="0.92"/>
  <rect x="1100" y="278" width="190" height="86" rx="14" fill="none" stroke="rgba(252,165,165,0.4)" stroke-width="1.5"/>
  <text x="1195" y="304" text-anchor="middle" font-size="18" fill="white">âš¡</text>
  <text x="1195" y="325" text-anchor="middle" font-size="12" font-weight="700" fill="white">Redis</text>
  <text x="1195" y="341" text-anchor="middle" font-size="10" fill="#fecaca">CSRF Â· Session Â· Rate limit</text>
  <text x="1195" y="355" text-anchor="middle" font-size="10" fill="#fca5a5">Bucket4j token store</text>

  <!-- ECOM-DB -->
  <rect x="80" y="472" width="200" height="80" rx="14" fill="url(#gDb)" filter="url(#glow)" opacity="0.92"/>
  <rect x="80" y="472" width="200" height="80" rx="14" fill="none" stroke="rgba(96,165,250,0.4)" stroke-width="1.5"/>
  <text x="180" y="497" text-anchor="middle" font-size="16" fill="white">ğŸ—„ï¸</text>
  <text x="180" y="518" text-anchor="middle" font-size="12" font-weight="700" fill="white">ecom-db</text>
  <text x="180" y="534" text-anchor="middle" font-size="10" fill="#93c5fd">PostgreSQL Â· WAL replication</text>
  <text x="180" y="542" text-anchor="middle" font-size="9" fill="#60a5fa">Books Â· Orders Â· Cart</text>

  <!-- INVENTORY-DB -->
  <rect x="390" y="472" width="200" height="80" rx="14" fill="url(#gDb)" filter="url(#glow)" opacity="0.92"/>
  <rect x="390" y="472" width="200" height="80" rx="14" fill="none" stroke="rgba(96,165,250,0.4)" stroke-width="1.5"/>
  <text x="490" y="497" text-anchor="middle" font-size="16" fill="white">ğŸ—„ï¸</text>
  <text x="490" y="518" text-anchor="middle" font-size="12" font-weight="700" fill="white">inventory-db</text>
  <text x="490" y="534" text-anchor="middle" font-size="10" fill="#93c5fd">PostgreSQL Â· WAL replication</text>
  <text x="490" y="542" text-anchor="middle" font-size="9" fill="#60a5fa">Stock Inventory table</text>

  <!-- DEBEZIUM -->
  <rect x="660" y="472" width="190" height="80" rx="14" fill="url(#gDebezium)" filter="url(#glow)" opacity="0.92"/>
  <rect x="660" y="472" width="190" height="80" rx="14" fill="none" stroke="rgba(252,165,165,0.4)" stroke-width="1.5"/>
  <text x="755" y="497" text-anchor="middle" font-size="16" fill="white">ğŸ”„</text>
  <text x="755" y="518" text-anchor="middle" font-size="12" font-weight="700" fill="white">Debezium CDC</text>
  <text x="755" y="534" text-anchor="middle" font-size="10" fill="#fca5a5">v2.7.0.Final</text>
  <text x="755" y="542" text-anchor="middle" font-size="9" fill="#f87171">PostgreSQL â†’ Kafka</text>

  <!-- KAFKA -->
  <rect x="940" y="472" width="200" height="80" rx="14" fill="url(#gKafka)" filter="url(#glowStrong)" opacity="0.95"/>
  <rect x="940" y="472" width="200" height="80" rx="14" fill="none" stroke="rgba(253,186,116,0.5)" stroke-width="1.5"/>
  <text x="1040" y="497" text-anchor="middle" font-size="16" fill="white">ğŸ“¨</text>
  <text x="1040" y="518" text-anchor="middle" font-size="12" font-weight="700" fill="white">Apache Kafka</text>
  <text x="1040" y="534" text-anchor="middle" font-size="10" fill="#fed7aa">KRaft Â· order.created</text>
  <text x="1040" y="542" text-anchor="middle" font-size="9" fill="#fdba74">inventory.updated</text>

  <!-- ANALYTICS CONSUMER -->
  <rect x="490" y="660" width="220" height="80" rx="14" fill="url(#gAnalytics)" filter="url(#glow)" opacity="0.92"/>
  <rect x="490" y="660" width="220" height="80" rx="14" fill="none" stroke="rgba(196,181,253,0.4)" stroke-width="1.5"/>
  <text x="600" y="685" text-anchor="middle" font-size="16" fill="white">âš™ï¸</text>
  <text x="600" y="706" text-anchor="middle" font-size="12" font-weight="700" fill="white">Analytics Consumer</text>
  <text x="600" y="722" text-anchor="middle" font-size="10" fill="#ddd6fe">Python Â· kafka-python-ng</text>
  <text x="600" y="730" text-anchor="middle" font-size="9" fill="#c4b5fd">Kafka events â†’ star schema</text>

  <!-- ANALYTICS-DB -->
  <rect x="790" y="660" width="200" height="80" rx="14" fill="url(#gAnalytics)" filter="url(#glow)" opacity="0.92"/>
  <rect x="790" y="660" width="200" height="80" rx="14" fill="none" stroke="rgba(196,181,253,0.4)" stroke-width="1.5"/>
  <text x="890" y="685" text-anchor="middle" font-size="16" fill="white">ğŸ“Š</text>
  <text x="890" y="706" text-anchor="middle" font-size="12" font-weight="700" fill="white">analytics-db</text>
  <text x="890" y="722" text-anchor="middle" font-size="10" fill="#ddd6fe">PostgreSQL Â· Star Schema</text>
  <text x="890" y="730" text-anchor="middle" font-size="9" fill="#c4b5fd">fact_orders Â· dim_books</text>

  <!-- SUPERSET -->
  <rect x="1060" y="660" width="220" height="80" rx="14" fill="url(#gSuperset)" filter="url(#glow)" opacity="0.92"/>
  <rect x="1060" y="660" width="220" height="80" rx="14" fill="none" stroke="rgba(165,243,252,0.4)" stroke-width="1.5"/>
  <text x="1170" y="685" text-anchor="middle" font-size="16" fill="white">ğŸ“ˆ</text>
  <text x="1170" y="706" text-anchor="middle" font-size="12" font-weight="700" fill="white">Apache Superset</text>
  <text x="1170" y="722" text-anchor="middle" font-size="10" fill="#cffafe">BI Â· ECharts dashboard</text>
  <text x="1170" y="730" text-anchor="middle" font-size="9" fill="#a5f3fc">localhost:32000</text>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STATIC CONNECTION PATHS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

  <!-- Browser â†’ KGateway (HTTPS) -->
  <line x1="700" y1="162" x2="700" y2="184" stroke="#10b981" stroke-width="2.5" marker-end="url(#arrowGreen)"/>

  <!-- Browser â†” Keycloak (OIDC PKCE) -->
  <path d="M 834 130 Q 1000 110 1050 210" fill="none" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="6,3" marker-end="url(#arrowOrange)"/>
  <text x="980" y="155" text-anchor="middle" font-size="9" fill="#f59e0b" font-weight="600">OIDC PKCE</text>

  <!-- KGateway â†’ UI Service -->
  <path d="M 600 256 L 350 256 L 350 278 L 300 278" fill="none" stroke="#6366f1" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <text x="430" y="250" text-anchor="middle" font-size="9" fill="#a5b4fc" font-weight="600">myecom.net</text>

  <!-- KGateway â†’ E-Commerce -->
  <path d="M 680 256 L 680 278 L 730 278" fill="none" stroke="#10b981" stroke-width="2" marker-end="url(#arrowGreen)"/>
  <text x="672" y="272" text-anchor="end" font-size="9" fill="#6ee7b7" font-weight="600">/ecom</text>

  <!-- KGateway â†’ Inventory -->
  <path d="M 780 256 L 780 278 L 800 278" fill="none" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrowOrange)"/>
  <text x="826" y="272" text-anchor="start" font-size="9" fill="#fde68a" font-weight="600">/inven</text>

  <!-- E-Commerce â†” Inventory (mTLS) -->
  <line x1="730" y1="321" x2="800" y2="321" stroke="rgba(255,255,255,0.4)" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowWhite)"/>
  <text x="765" y="315" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.6)">mTLS</text>

  <!-- UI â†’ Redis (CSRF) -->
  <path d="M 300 321 Q 700 310 1100 321" fill="none" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrowRed)"/>
  <text x="700" y="306" text-anchor="middle" font-size="9" fill="#fca5a5">CSRF tokens</text>

  <!-- E-Commerce â†’ Redis (rate limit) -->
  <path d="M 730 310 Q 900 290 1100 310" fill="none" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrowRed)"/>

  <!-- E-Commerce â†’ ecom-db -->
  <path d="M 530 364 L 530 450 L 180 450 L 180 472" fill="none" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <text x="340" y="446" text-anchor="middle" font-size="9" fill="#93c5fd">JDBC</text>

  <!-- Inventory â†’ inventory-db -->
  <path d="M 860 364 L 860 450 L 490 450 L 490 472" fill="none" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <text x="670" y="446" text-anchor="middle" font-size="9" fill="#93c5fd">JDBC</text>

  <!-- ecom-db â†’ Debezium -->
  <line x1="280" y1="512" x2="660" y2="512" stroke="#dc2626" stroke-width="2" marker-end="url(#arrowRed)"/>
  <text x="470" y="505" text-anchor="middle" font-size="9" fill="#f87171">WAL CDC</text>

  <!-- inventory-db â†’ Debezium -->
  <line x1="590" y1="528" x2="660" y2="528" stroke="#dc2626" stroke-width="1.5" marker-end="url(#arrowRed)"/>

  <!-- Debezium â†’ Kafka -->
  <line x1="850" y1="512" x2="940" y2="512" stroke="#ea580c" stroke-width="2.5" marker-end="url(#arrowKafka)"/>
  <text x="895" y="505" text-anchor="middle" font-size="9" fill="#fdba74">events</text>

  <!-- E-Commerce â†’ Kafka (publish order.created) -->
  <path d="M 680 364 L 680 440 L 1040 440 L 1040 472" fill="none" stroke="#ea580c" stroke-width="2" marker-end="url(#arrowKafka)"/>
  <text x="870" y="436" text-anchor="middle" font-size="9" fill="#fdba74" font-weight="600">order.created</text>

  <!-- Inventory â†’ Kafka (publish inventory.updated) -->
  <path d="M 1000 364 L 1000 440 L 1060 440 L 1060 472" fill="none" stroke="#ea580c" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrowKafka)"/>
  <text x="1100" y="436" text-anchor="middle" font-size="9" fill="#fdba74">inv.updated</text>

  <!-- Kafka â†’ Analytics Consumer -->
  <path d="M 1040 552 L 1040 630 L 710 630 L 710 660" fill="none" stroke="#8b5cf6" stroke-width="2.5" marker-end="url(#arrowPurple)"/>
  <text x="875" y="626" text-anchor="middle" font-size="9" fill="#c4b5fd" font-weight="600">consume events</text>

  <!-- Analytics Consumer â†’ analytics-db -->
  <line x1="710" y1="700" x2="790" y2="700" stroke="#8b5cf6" stroke-width="2.5" marker-end="url(#arrowPurple)"/>
  <text x="750" y="693" text-anchor="middle" font-size="9" fill="#c4b5fd">INSERT</text>

  <!-- analytics-db â†’ Superset -->
  <line x1="990" y1="700" x2="1060" y2="700" stroke="#0891b2" stroke-width="2.5" marker-end="url(#arrowTeal)"/>
  <text x="1025" y="693" text-anchor="middle" font-size="9" fill="#7dd3fc">SQL queries</text>

  <!-- Keycloak â†’ keycloak-db (faint) -->
  <line x1="1160" y1="256" x2="1160" y2="320" stroke="rgba(245,158,11,0.3)" stroke-width="1.5" stroke-dasharray="4,3"/>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ANIMATED DOTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

  <!-- Flow 1: Browser request through KGateway â†’ UI Service (Blue, 4s) -->
  <circle r="5" fill="#60a5fa" filter="url(#glow)" opacity="0.9">
    <animateMotion dur="4s" repeatCount="indefinite" begin="0s">
      <mpath href="#path-browser-to-ui"/>
    </animateMotion>
  </circle>

  <!-- Flow 2: API request KGateway â†’ E-Commerce (Green, 3s) -->
  <circle r="5" fill="#34d399" filter="url(#glow)" opacity="0.9">
    <animateMotion dur="3s" repeatCount="indefinite" begin="0.5s">
      <mpath href="#path-gateway-to-ecom"/>
    </animateMotion>
  </circle>

  <!-- Flow 3: E-Commerce â†’ ecom-db (Blue, 2.5s) -->
  <circle r="4" fill="#93c5fd" filter="url(#glow)" opacity="0.85">
    <animateMotion dur="2.5s" repeatCount="indefinite" begin="1s">
      <mpath href="#path-ecom-to-db"/>
    </animateMotion>
  </circle>

  <!-- Flow 4: order.created to Kafka (Orange, 3.5s) -->
  <circle r="5" fill="#fb923c" filter="url(#glow)" opacity="0.9">
    <animateMotion dur="3.5s" repeatCount="indefinite" begin="1.5s">
      <mpath href="#path-ecom-to-kafka"/>
    </animateMotion>
  </circle>

  <!-- Flow 5: CDC WAL ecom-db â†’ Debezium (Red, 4s) -->
  <circle r="4" fill="#f87171" filter="url(#glow)" opacity="0.85">
    <animateMotion dur="4s" repeatCount="indefinite" begin="2s">
      <mpath href="#path-cdc-wal"/>
    </animateMotion>
  </circle>

  <!-- Flow 6: Debezium â†’ Kafka (Orange, 2s) -->
  <circle r="5" fill="#fb923c" filter="url(#glow)" opacity="0.9">
    <animateMotion dur="2s" repeatCount="indefinite" begin="2.5s">
      <mpath href="#path-debezium-to-kafka"/>
    </animateMotion>
  </circle>

  <!-- Flow 7: Kafka â†’ Analytics Consumer (Purple, 5s) -->
  <circle r="5" fill="#a78bfa" filter="url(#glow)" opacity="0.9">
    <animateMotion dur="5s" repeatCount="indefinite" begin="0.2s">
      <mpath href="#path-kafka-to-consumer"/>
    </animateMotion>
  </circle>

  <!-- Flow 8: Consumer â†’ analytics-db (Purple, 2.5s) -->
  <circle r="4" fill="#c4b5fd" filter="url(#glow)" opacity="0.85">
    <animateMotion dur="2.5s" repeatCount="indefinite" begin="3s">
      <mpath href="#path-consumer-to-analyticsdb"/>
    </animateMotion>
  </circle>

  <!-- Flow 9: analytics-db â†’ Superset (Teal, 4s) -->
  <circle r="4" fill="#22d3ee" filter="url(#glow)" opacity="0.85">
    <animateMotion dur="4s" repeatCount="indefinite" begin="1.8s">
      <mpath href="#path-analyticsdb-to-superset"/>
    </animateMotion>
  </circle>

  <!-- Flow 10: OIDC auth loop (Yellow, 6s) -->
  <circle r="4" fill="#fbbf24" filter="url(#glow)" opacity="0.8">
    <animateMotion dur="6s" repeatCount="indefinite" begin="0.8s">
      <mpath href="#path-oidc"/>
    </animateMotion>
  </circle>

  <!-- Flow 11: Inventory â†’ Kafka (Orange, 4s) -->
  <circle r="4" fill="#fb923c" filter="url(#glow)" opacity="0.8">
    <animateMotion dur="4s" repeatCount="indefinite" begin="3.5s">
      <mpath href="#path-inven-to-kafka"/>
    </animateMotion>
  </circle>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ANIMATION PATHS (hidden) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <defs>
    <!-- Browser â†’ KGateway â†’ UI -->
    <path id="path-browser-to-ui" d="M 700 162 L 700 220 L 350 256 L 300 278 L 190 278"/>

    <!-- KGateway â†’ E-Commerce -->
    <path id="path-gateway-to-ecom" d="M 700 256 L 700 278 L 730 278 L 610 278"/>

    <!-- E-Commerce â†’ ecom-db -->
    <path id="path-ecom-to-db" d="M 530 364 L 530 450 L 180 450 L 180 472"/>

    <!-- E-Commerce â†’ Kafka (order.created) -->
    <path id="path-ecom-to-kafka" d="M 680 364 L 680 440 L 1040 440 L 1040 472"/>

    <!-- ecom-db WAL â†’ Debezium -->
    <path id="path-cdc-wal" d="M 280 512 L 660 512"/>

    <!-- Debezium â†’ Kafka -->
    <path id="path-debezium-to-kafka" d="M 850 512 L 940 512"/>

    <!-- Kafka â†’ Analytics Consumer -->
    <path id="path-kafka-to-consumer" d="M 1040 552 L 1040 630 L 710 630 L 710 660"/>

    <!-- Consumer â†’ analytics-db -->
    <path id="path-consumer-to-analyticsdb" d="M 710 700 L 790 700"/>

    <!-- analytics-db â†’ Superset -->
    <path id="path-analyticsdb-to-superset" d="M 990 700 L 1060 700"/>

    <!-- OIDC auth flow -->
    <path id="path-oidc" d="M 834 130 Q 1000 110 1100 210 L 1100 256"/>

    <!-- Inventory â†’ Kafka -->
    <path id="path-inven-to-kafka" d="M 1000 364 L 1000 440 L 1060 440 L 1060 472"/>
  </defs>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LEGEND â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <rect x="80" y="757" width="680" height="52" rx="8" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>
  <text x="420" y="777" text-anchor="middle" font-size="11" font-weight="700" fill="rgba(255,255,255,0.8)">Legend</text>
  <line x1="100" y1="795" x2="130" y2="795" stroke="#60a5fa" stroke-width="2.5" marker-end="url(#arrowBlue)"/>
  <text x="205" y="799" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.7)">HTTPS / REST</text>
  <line x1="260" y1="795" x2="290" y2="795" stroke="#fb923c" stroke-width="2.5" marker-end="url(#arrowKafka)"/>
  <text x="365" y="799" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.7)">Kafka events</text>
  <line x1="420" y1="795" x2="450" y2="795" stroke="#a78bfa" stroke-width="2.5" marker-end="url(#arrowPurple)"/>
  <text x="525" y="799" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.7)">CDC pipeline</text>
  <line x1="580" y1="795" x2="610" y2="795" stroke="rgba(255,255,255,0.4)" stroke-width="2" stroke-dasharray="4,3" marker-end="url(#arrowWhite)"/>
  <text x="690" y="799" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.7)">mTLS (encrypted)</text>

  <!-- Animated dots legend -->
  <circle cx="100" cy="795" r="4" fill="#60a5fa" opacity="0.8">
    <animate attributeName="opacity" values="0.8;0.3;0.8" dur="1.5s" repeatCount="indefinite"/>
  </circle>
  <circle cx="260" cy="795" r="4" fill="#fb923c" opacity="0.8">
    <animate attributeName="opacity" values="0.8;0.3;0.8" dur="1.5s" repeatCount="indefinite" begin="0.5s"/>
  </circle>
  <circle cx="420" cy="795" r="4" fill="#a78bfa" opacity="0.8">
    <animate attributeName="opacity" values="0.8;0.3;0.8" dur="1.5s" repeatCount="indefinite" begin="1s"/>
  </circle>

  <!-- Footer -->
  <text x="700" y="814" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.3)">BookStore Platform Â· Istio Ambient Mesh Â· All inter-service traffic encrypted via mTLS</text>
</svg>
